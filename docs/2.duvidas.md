# Dúvidas

## Sumário

1. [Estrutura da aplicação: qual a melhor abordagem?](#estrutura-da-aplicação-qual-a-melhor-abordagem)
2. [Supondo que vá com "bff"+api no mesmo backend em python, quais as implicações?](#supondo-que-vá-com-bffapi-no-mesmo-backend-em-python-quais-as-implicações)
3. [Se eu fosse de NextJs com BFF separado](#se-eu-fose-de-nextjs-com-bff-separado)
   - [Como faria a questão do banco de dados?](#como-faria-a-questao-do-banco-de-dados)
   - [Infra](#infra)
4. [Se eu fosse de backend python + frontend Vite](#se-eu-fosse-de-backend-python--frontend-vite)
   - [Como seria o auth?](#como-seria-o-auth)
   - [Infra](#infra-1)
   - [Outras questões relevantes](#outras-questões-relevantes)
5. [Domínios](#domínios)
6. [Dado nosso contexto, qual abordagem vc recomendaria?](#dado-nosso-contexto-qual-abordagem-vc-recomendaria)

---

## Estrutura da aplicação: qual a melhor abordagem?

a) backend ("bff" + api) em python em 1 CloudRun só e frontend em Vite
b) api em python em CRun privado, e outro CRun (publico) com Nextjs fazendo BFF (pra cuidar de auth (google oauth2, email/senha etc)) bem cm o frontend.

## Supondo que vá com "bff"+api no mesmo backend em python, quais as implicações?

a) o fato de concentrar "api" e "bff" no mesmo endpoint geraria algum problema relevante de seguranca?
b) e como fica questao de CORS?
c) alguma outra desvantagem relavente em relacao ao esquema bff em NextJs?

## Se eu fose de NextJs com BFF separado

### Como faria a questao do banco de dados?

Só por curiosidade, suponha q eu fosse de NextJs com o BFF dele concentrando a parte do OAuth2 google ou email msm.

Ouvi dizer q haveria 2 abordagens possiveis:

a) bff enxerga banco e escreve o q for necessario la (user, user_identities, sessions etc)

Alem disso, 2 subpossibildades aqui:

a.1) o bff poderia mexer em schema (prisma etc)

a.2) o esquema so seria mexido pelo lado python (alchemy), d forma q bff so escrevesse em tabelas mediante contrato bem definido entre as "moving partes" (api e bff)

b. bff NAO enxergaria banco: pra email/senha, validaria no python (q conhece users no banco) e geraria e gerwnciaria jwt, cookie etc. Pra oauth2 (google),


Dito isso, qual sua recomendacao supondo q fossemos usar nextjs pra bff+front?

Ou, na verdade, haveria uma terceira possibilidade q vc consideraria melhor?

### Infra

a) 2 CRun (1 api, 1 bff+front)?
b) precisaria de algo mais complexo (load balancer etc)?


## Se eu fosse de backend python + frontend Vite

### Como seria o auth?

1) email/senha?
2) google oauth2?

### Infra

a) 1 CRun só (api + bff) com o frontend em Vite separado (GCS? Precisaria load balancer?)?
b) 2 CRun (1 api, 1 bff)?

### Outras questões relevantes

1) CORS?
2) Segurança?

## Domínios

1) app.pilotodevendas.com.br (frontend vite) e api.pilotodevendas.com.br (backend python)?
2) tudo em app.pilotodevendas.com.br (com api em /api/*)?
3) outra abordagem?

## Dado nosso contexto, qual abordagem vc recomendaria?

??
